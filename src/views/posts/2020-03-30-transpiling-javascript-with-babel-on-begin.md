---
title: Transpiling JavaScript with Babel on Begin
image: 'image.png' 
category: uncategorized
description: In this post weâ€™ll demonstrate using Babel to implement a great new unreleased JS feature:optional chaining.
author: 'Paul Chin Jr'
avi: 'paul.jpg'
readtime: '4 mins'
published: 'March 30, 2020'
---

![arc19](post-assets/arc19.jpg)

Transpilers are tools that read source code in one syntax and output it into another syntax. For example, your source could be written in TypeScript, or utilize an experimental language feature, and a transpiler will make sure it turns into standard JS. Transpilers let developers work with a wider variety tools, while also keeping the output compliant with browsers and Node.js.

In this post weâ€™ll demonstrate using [Babel](https://babeljs.io/docs/en/) to implement a great new unreleased JS feature: [optional chaining](https://github.com/tc39/proposal-optional-chaining).

## Try out Babel with Begin right now!

Hit this button to deploy a new Node.js + Babel example app to Begin in 15 seconds:

![Deploy to begin](deploy-to-begin.png)

## Setting up a new project

You can follow along with the complete example, or start from scratch:

```bash
# make a new project folder 
mkdir learn-node-babel
cd learn-node-babel
# install dependencies
npm init -y
npm install @architect/architect @babel/core @babel/cli @babel/plugin-proposal-optional-chaining @babel/preset-env
```

> Note: Here are the docs for [installing Babel](https://babeljs.io/setup#installation). I had to install `Xcode Command Line `Tools according to [this post](https://github.com/nodejs/node-gyp/blob/master/macOS_Catalina.md) to have `node-gyp` build properly on macOS.

## Create a Lambda function in a folder called /lib

```bash
# create a new folder 
mkdir -p lib/http/get-index
# create a file for the Lambda handler 
touch /lib/http/get-index/index.js
```

Now weâ€™re going to write our Lambda function.

```js
// lib/http/get-index/index.js
export async function handler(req) {  
  return {
    headers: {
      'content-type': 'text/html; charset=utf8'    
    },    
    body: `<pre>req?.queryStringParameters?.foo: ${req?.queryStringParameters?.foo}</pre>`  
  }
}
```

This function is waiting for a `GET` request to your application index, then it will look for `queryStringParameters` with the property `foo` and return the value back to the browser in the response body.

Normally in JavaScript, accessing a deeply nested property that doesnâ€™t exist would throw an error.

But by using a JavaScript language feature called [optional chaining](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Optional_chaining) (currently at [Stage 4 of a TC39 proposal](https://github.com/tc39/proposal-optional-chaining)), we can use this syntax right now by transpiling it to existing JavaScript standards in Node with Babel.

This means your code wonâ€™t error if `foo` isnâ€™t found. And if so inclined, you can also write a default value, too: `req.params?.foo || 'somedefaultvalue'`

![arc19](post-assets/arc19.jpg)

<small>Photo by Samson on Unsplash</small>


## Set up Babel

Now we can add a `babel.config.js` in our project root to configure Babel to convert the function to a CommonJS module. Babel will then run it through a preset that knows how to rewrite our source to make use of the optional chaining syntax.

```js
// babel.config.js
module.exports = function(api) {
  api.cache(false)
  return {
    presets: [[
      "@babel/preset-env",
      { targets: { node: true }, modules: 'cjs' }
    ]],
    plugins: [[
      "@babel/plugin-proposal-optional-chaining"
    ]]
  }
}
```

## Add `start` and `build` scripts to `package.json`

```json
# package.json
"scripts": {
  "build": "npx babel ./lib -d ./src --copy-files --include dotfiles",
  "start": "npm run build & npx sandbox"
}
```

The `build` script will consider the entire `/lib` directory and run `Babel` output to /src with the same folder structure. The code inside of `/src` is what will be deployed to the cloud.

Now we can run `npm start` to both run Babel and start `@architect/sandbox` (a local development environment that emulates AWS API Gateway, Lambda, and an in-memory instance of DynamoDB).

![arc20](post-assets/arc20.jpg)

<small>Photo by Allie Smith on Unsplash</small>

## Checking the output

You should see this code inside /src that was generated by Babel:

```js
// src/http/get-index/index.js
"use strict";
Object.defineProperty(exports, "__esModule", { 
  value: true 
});
exports.handler = handler;
async function handler(req) {
  return {
    headers: {
      'content-type': 'text/html; charset=utf8'
    },
    body: `<pre>req?.queryStringParameters?.foo: ${(req === null || req === void 0 ? void 0 : req.queryStringParameters.foo) || 11} </pre>`
  };
}
```

Our original code looks a bit better, donâ€™t you think?

## Thatâ€™s it!

Congrats! Now go flex your new JavaScript powers and test out more [experimental JavaScript features!](https://babeljs.io/docs/en/plugins/#experimental)

## Next Steps

- Deploy an AVA example app to Begin in 15 seconds:

![Deploy to begin](deploy-to-begin.png)

- [Try out another Begin tutorial, like a full CRUD app with Begin Data!](https://docs.begin.com/en/guides/crud-app)
- ðŸŒŸ Check out (and star!) Beginâ€™s open core [OpenJS Architect](https://github.com/architect/architect) on GitHub